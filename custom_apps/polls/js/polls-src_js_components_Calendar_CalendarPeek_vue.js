"use strict";(self.webpackChunkpolls=self.webpackChunkpolls||[]).push([["src_js_components_Calendar_CalendarPeek_vue"],{99457:(t,n,e)=>{e.d(n,{Z:()=>s});var a=e(87537),r=e.n(a),o=e(23645),i=e.n(o)()(r());i.push([t.id,".calendar-info{display:flex;align-items:center;border-radius:var(--border-radius);margin:4px 0;padding:0 4px}.calendar-info .summay{margin-left:4px}.calendar-info.conflict-ignore{border-left:4px solid rgba(0,0,0,0)}.calendar-info.conflict-ignore .summay{font-weight:bold}.calendar-info.conflict-no{border-left:4px solid var(--color-success)}.calendar-info.cancelled{text-decoration:line-through;opacity:.5}.calendar-info.tentative{opacity:.5}.calendar-info.conflict-yes{border-left:4px solid var(--color-error)}.calendar-info__time{width:65px;font-size:.8em;flex:0 auto}","",{version:3,sources:["webpack://./src/js/components/Calendar/CalendarInfo.vue"],names:[],mappings:"AAEA,eACC,YAAA,CACA,kBAAA,CACA,kCAAA,CACA,YAAA,CACA,aAAA,CAEA,uBACC,eAAA,CAGD,+BACC,mCAAA,CACA,uCACC,gBAAA,CAIF,2BACC,0CAAA,CAGD,yBACC,4BAAA,CACA,UAAA,CAGD,yBACC,UAAA,CAGD,4BACC,wCAAA,CAIF,qBACC,UAAA,CACA,cAAA,CACA,WAAA",sourcesContent:["\n\n.calendar-info {\n\tdisplay: flex;\n\talign-items: center;\n\tborder-radius: var(--border-radius);\n\tmargin: 4px 0;\n\tpadding: 0 4px;\n\n\t.summay {\n\t\tmargin-left: 4px;\n\t}\n\n\t&.conflict-ignore {\n\t\tborder-left: 4px solid transparent;\n\t\t.summay {\n\t\t\tfont-weight: bold;\n\t\t}\n\t}\n\n\t&.conflict-no {\n\t\tborder-left: 4px solid var(--color-success);\n\t}\n\n\t&.cancelled {\n\t\ttext-decoration: line-through;\n\t\topacity: 0.5;\n\t}\n\n\t&.tentative {\n\t\topacity: 0.5;\n\t}\n\n\t&.conflict-yes {\n\t\tborder-left: 4px solid var(--color-error);\n\t}\n}\n\n.calendar-info__time {\n\twidth: 65px;\n\tfont-size: 0.8em;\n\tflex: 0 auto;\n}\n"],sourceRoot:""}]);const s=i},53587:(t,n,e)=>{e.d(n,{Z:()=>s});var a=e(87537),r=e.n(a),o=e(23645),i=e.n(o)()(r());i.push([t.id,".calendar-peek{flex-direction:column}.calendar-peek__conflict.icon{width:32px;height:32px;background-color:var(--color-warning);border-radius:50%;margin:4px auto}.calendar-peek__caption{font-size:.7em}.calendar-peek__grid{padding:8px;background-color:var(--color-main-background);border-radius:var(--border-radius)}","",{version:3,sources:["webpack://./src/js/components/Calendar/CalendarPeek.vue"],names:[],mappings:"AAEA,eACC,qBAAA,CAGD,8BACC,UAAA,CACA,WAAA,CACA,qCAAA,CACA,iBAAA,CACA,eAAA,CAGD,wBACC,cAAA,CAGD,qBACC,WAAA,CACA,6CAAA,CACA,kCAAA",sourcesContent:["\n\n.calendar-peek {\n\tflex-direction: column;\n}\n\n.calendar-peek__conflict.icon {\n\twidth: 32px;\n\theight: 32px;\n\tbackground-color: var(--color-warning);\n\tborder-radius: 50%;\n\tmargin: 4px auto;\n}\n\n.calendar-peek__caption {\n\tfont-size: 0.7em;\n}\n\n.calendar-peek__grid {\n\tpadding: 8px;\n\tbackground-color: var(--color-main-background);\n\tborder-radius: var(--border-radius);\n}\n\n"],sourceRoot:""}]);const s=i},7017:(t,n,e)=>{e.r(n),e.d(n,{default:()=>Z});var a=function(){var t=this,n=t._self._c;return t.events.length?n("NcPopover",{staticClass:"calendar-peek",scopedSlots:t._u([{key:"trigger",fn:function(){return[n("div",[n("div",{staticClass:"calendar-peek__conflict icon icon-calendar"}),n("p",{staticClass:"calendar-peek__caption"},[t._v(" "+t._s(t.t("polls","Conflict"))+" ")])])]},proxy:!0}],null,!1,2438961837)},[n("div",{staticClass:"calendar-peek__grid"},t._l(t.sortedEvents,(function(e){return n("CalendarInfo",{key:e.UID,attrs:{"calendar-event":e,option:t.option}})})),1)]):t._e()};a._withStripped=!0;var r=e(20629),o=e(96486),i=e(15961),s=e(80351),l=e.n(s),d=function(){var t=this,n=t._self._c;return n("div",{staticClass:"calendar-info",class:[t.conflictLevel,t.statusClass],style:t.calendarStyle},[n("div",{staticClass:"calendar-info__time"},[t._v(" "+t._s(t.showJustDays?t.dayDisplay:t.timeDisplay)+" ")]),n("div",{staticClass:"summay",class:t.statusClass},[t._v(" "+t._s(t.calendarEvent.summary)+" ")])])};d._withStripped=!0;const c={name:"CalendarInfo",props:{calendarEvent:{type:Object,default:void 0},option:{type:Object,default:void 0}},computed:{calendarStyle(){return{backgroundColor:this.calendarEvent.displayColor,color:this.fontColor}},dayStart(){return l().unix(this.calendarEvent.start).format("ddd")},dayEnd(){return l().unix(this.calendarEvent.end-1).format("ddd")},dayDisplay(){return this.dayEnd===this.dayStart?this.dayStart:"".concat(this.dayStart," - ").concat(this.dayEnd)},timeStart(){return l().unix(this.calendarEvent.start).format("LT")},timeEnd(){return l().unix(this.calendarEvent.end).format("LT")},timeDisplay(){return this.timeEnd===this.timeStart?this.timeStart:"".concat(this.timeStart," - ").concat(this.timeEnd)},showJustDays(){return this.dayStart!==this.dayEnd||this.calendarEvent.allDay},statusClass(){return this.calendarEvent.status.toLowerCase()},fontColor(){if("transparent"===this.calendarEvent.displayColor)return"var(--color-main-text)";const t=this.calendarEvent.displayColor.replace(/#/,"");return[.299*parseInt(t.slice(0,2),16),.587*parseInt(t.slice(2,4),16),.114*parseInt(t.slice(4,6),16)].reduce(((t,n)=>t+n))/255>.5?"#222":"#ddd"},conflictLevel(){return 0===this.calendarEvent.calendarKey?"conflict-ignore":this.calendarEvent.start>=this.option.timestamp+this.option.duration||this.calendarEvent.end<=this.option.timestamp?"conflict-no":"conflict-yes"}}};var A=e(93379),p=e.n(A),u=e(7795),C=e.n(u),m=e(90569),h=e.n(m),f=e(3565),v=e.n(f),y=e(19216),g=e.n(y),x=e(44589),_=e.n(x),b=e(99457),E={};E.styleTagTransform=_(),E.setAttributes=v(),E.insert=h().bind(null,"head"),E.domAPI=C(),E.insertStyleElement=g();p()(b.Z,E);b.Z&&b.Z.locals&&b.Z.locals;var k=e(51900);const D=(0,k.Z)(c,d,[],!1,null,null,null).exports;var w=e(23573);const B={name:"CalendarPeek",components:{CalendarInfo:D,NcPopover:i.Fh},props:{option:{type:Object,default:void 0}},data:()=>({events:[]}),computed:{...(0,r.rn)({poll:t=>t.poll}),detectAllDay(){const t=l().unix(this.option.timestamp),n=l().unix(this.option.timestamp+Math.max(0,this.option.duration)),e=t.unix()===l()(t).startOf("day").unix()&&n.unix()===l()(n).startOf("day").unix()&&t.unix()!==n.unix();return{allDay:e,type:e?"date":"dateTime"}},sortedEvents(){const t=[...this.events];return t.push(this.thisOption),(0,o.orderBy)(t,["start","end"],["asc","asc"])},thisOption(){return{id:this.option.id,UID:this.option.id,calendarUri:this.poll.uri,calendarKey:0,calendarName:"Polls",displayColor:"transparent",allDay:this.detectAllDay.allDay,description:this.poll.description,start:this.option.timestamp,location:"",end:this.option.timestamp+this.option.duration,status:"self",summary:this.poll.title,type:this.detectAllDay.type}}},mounted(){this.getEvents()},methods:{async getEvents(){try{const t=await w.c.getEvents(this.option.id);this.events=t.data.events}catch(t){if("ERR_CANCELED"===(null==t?void 0:t.code))return;console.error("Error fetching events",{error:t.response})}}}};var S=e(53587),I={};I.styleTagTransform=_(),I.setAttributes=v(),I.insert=h().bind(null,"head"),I.domAPI=C(),I.insertStyleElement=g();p()(S.Z,I);S.Z&&S.Z.locals&&S.Z.locals;const Z=(0,k.Z)(B,a,[],!1,null,null,null).exports}}]);
//# sourceMappingURL=polls-src_js_components_Calendar_CalendarPeek_vue.js.map?v=d7c6e69801a174a22e4e