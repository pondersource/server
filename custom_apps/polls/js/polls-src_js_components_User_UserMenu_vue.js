/*! For license information please see polls-src_js_components_User_UserMenu_vue.js.LICENSE.txt */
"use strict";(self.webpackChunkpolls=self.webpackChunkpolls||[]).push([["src_js_components_User_UserMenu_vue"],{53154:(t,e,i)=>{i.d(e,{c:()=>a});var s=i(67514);const a={validateEmailAddress(t){return s.cF.request({method:"GET",url:"check/emailaddress/".concat(t),cancelToken:l[this.validateEmailAddress.name].handleRequestCancellation().token})},validateName(t,e){return s.cF.request({method:"POST",url:"check/username",cancelToken:l[this.validateName.name].handleRequestCancellation().token,data:{userName:e,token:t}})}},l=(0,s.c1)(a)},15101:(t,e,i)=>{i.d(e,{Z:()=>l});var s=function(){var t=this,e=t._self._c;return e("span",t._b({staticClass:"material-design-icon clipboard-arrow-left-outline-icon",attrs:{"aria-hidden":!t.title,"aria-label":t.title,role:"img"},on:{click:function(e){return t.$emit("click",e)}}},"span",t.$attrs,!1),[e("svg",{staticClass:"material-design-icon__svg",attrs:{fill:t.fillColor,width:t.size,height:t.size,viewBox:"0 0 24 24"}},[e("path",{attrs:{d:"M19,3A2,2 0 0,1 21,5V19A2,2 0 0,1 19,21H5A2,2 0 0,1 3,19V5A2,2 0 0,1 5,3H9.18C9.6,1.84 10.7,1 12,1C13.3,1 14.4,1.84 14.82,3H19M12,3A1,1 0 0,0 11,4A1,1 0 0,0 12,5A1,1 0 0,0 13,4A1,1 0 0,0 12,3M7,7V5H5V19H19V5H17V7H7M7,13L12,18V15H16V11H12V8L7,13Z"}},[t.title?e("title",[t._v(t._s(t.title))]):t._e()])])])};s._withStripped=!0;const a={name:"ClipboardArrowLeftOutlineIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};const l=(0,i(51900).Z)(a,s,[],!1,null,null,null).exports},50171:(t,e,i)=>{i.d(e,{Z:()=>l});var s=function(){var t=this,e=t._self._c;return e("span",t._b({staticClass:"material-design-icon delete-icon",attrs:{"aria-hidden":!t.title,"aria-label":t.title,role:"img"},on:{click:function(e){return t.$emit("click",e)}}},"span",t.$attrs,!1),[e("svg",{staticClass:"material-design-icon__svg",attrs:{fill:t.fillColor,width:t.size,height:t.size,viewBox:"0 0 24 24"}},[e("path",{attrs:{d:"M19,4H15.5L14.5,3H9.5L8.5,4H5V6H19M6,19A2,2 0 0,0 8,21H16A2,2 0 0,0 18,19V7H6V19Z"}},[t.title?e("title",[t._v(t._s(t.title))]):t._e()])])])};s._withStripped=!0;const a={name:"DeleteIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};const l=(0,i(51900).Z)(a,s,[],!1,null,null,null).exports},30967:(e,i,s)=>{s.r(i),s.d(i,{default:()=>I});var a=function(){var t=this,e=t._self._c;return e("NcActions",{attrs:{primary:""},scopedSlots:t._u([{key:"icon",fn:function(){return[e("SettingsIcon",{attrs:{size:20,decorative:""}})]},proxy:!0}])},["publicVote"===t.$route.name?e("NcActionButton",{on:{click:function(e){return t.copyLink()}},scopedSlots:t._u([{key:"icon",fn:function(){return[e("ClippyIcon")]},proxy:!0}],null,!1,964930807)},[t._v(" "+t._s(t.t("polls","Copy your personal link to clipboard"))+" ")]):t._e(),"publicVote"===t.$route.name?e("NcActionSeparator"):t._e(),"publicVote"===t.$route.name?e("NcActionInput",t._b({attrs:{value:t.userEmail.inputValue},on:{"update:value":[function(e){return t.$set(t.userEmail,"inputValue",e)},t.validateEmailAddress],submit:t.submitEmailAddress},scopedSlots:t._u([{key:"icon",fn:function(){return[e("EditEmailIcon")]},proxy:!0}],null,!1,1491380408)},"NcActionInput",t.userEmail.inputProps,!1),[t._v(" "+t._s(t.t("polls","Edit Email Address"))+" ")]):t._e(),"publicVote"===t.$route.name?e("NcActionInput",t._b({attrs:{value:t.userName.inputValue},on:{"update:value":[function(e){return t.$set(t.userName,"inputValue",e)},t.validateDisplayName],submit:t.submitDisplayName},scopedSlots:t._u([{key:"icon",fn:function(){return[e("EditAccountIcon")]},proxy:!0}],null,!1,3763356213)},"NcActionInput",t.userName.inputProps,!1),[t._v(" "+t._s(t.t("polls","Change name"))+" ")]):t._e(),"publicVote"===t.$route.name?e("NcActionButton",{attrs:{disabled:!t.emailAddress,value:t.emailAddress},on:{click:function(e){return t.resendInvitation()}},scopedSlots:t._u([{key:"icon",fn:function(){return[e("SendLinkPerEmailIcon")]},proxy:!0}],null,!1,3743478015)},[t._v(" "+t._s(t.t("polls","Get your personal link per mail"))+" ")]):t._e(),e("NcActionCheckbox",{attrs:{checked:t.subscribed,disabled:!t.acl.allowSubscribe,title:"check"},on:{change:t.toggleSubscription}},[t._v(" "+t._s(t.t("polls","Subscribe to notifications"))+" ")]),"publicVote"===t.$route.name&&t.emailAddress?e("NcActionButton",{attrs:{disabled:!t.emailAddress},on:{click:t.deleteEmailAddress},scopedSlots:t._u([{key:"icon",fn:function(){return[e("DeleteIcon")]},proxy:!0}],null,!1,3930079857)},[t._v(" "+t._s(t.t("polls","Remove Email Address"))+" ")]):t._e(),t.acl.allowEdit?e("NcActionButton",{on:{click:function(e){return t.getAddresses()}},scopedSlots:t._u([{key:"icon",fn:function(){return[e("ClippyIcon")]},proxy:!0}],null,!1,964930807)},[t._v(" "+t._s(t.t("polls","Copy list of email addresses to clipboard"))+" ")]):t._e(),e("NcActionButton",{on:{click:function(e){return t.resetVotes()}},scopedSlots:t._u([{key:"icon",fn:function(){return[e("ResetVotesIcon")]},proxy:!0}])},[t._v(" "+t._s(t.t("polls","Reset your votes"))+" ")]),"publicVote"===t.$route.name&&t.hasCookie?e("NcActionButton",{on:{click:function(e){return t.logout()}},scopedSlots:t._u([{key:"icon",fn:function(){return[e("LogoutIcon")]},proxy:!0}],null,!1,3113109122)},[t._v(" "+t._s(t.t("polls","Logout as {name} (delete cookie)",{name:t.acl.displayName}))+" ")]):t._e()],1)};a._withStripped=!0;var l=s(96486),n=s(64024),r=s(15961),o=s(20629),c=s(40192),u=function(){var t=this,e=t._self._c;return e("span",t._b({staticClass:"material-design-icon account-edit-icon",attrs:{"aria-hidden":!t.title,"aria-label":t.title,role:"img"},on:{click:function(e){return t.$emit("click",e)}}},"span",t.$attrs,!1),[e("svg",{staticClass:"material-design-icon__svg",attrs:{fill:t.fillColor,width:t.size,height:t.size,viewBox:"0 0 24 24"}},[e("path",{attrs:{d:"M21.7,13.35L20.7,14.35L18.65,12.3L19.65,11.3C19.86,11.09 20.21,11.09 20.42,11.3L21.7,12.58C21.91,12.79 21.91,13.14 21.7,13.35M12,18.94L18.06,12.88L20.11,14.93L14.06,21H12V18.94M12,14C7.58,14 4,15.79 4,18V20H10V18.11L14,14.11C13.34,14.03 12.67,14 12,14M12,4A4,4 0 0,0 8,8A4,4 0 0,0 12,12A4,4 0 0,0 16,8A4,4 0 0,0 12,4Z"}},[t.title?e("title",[t._v(t._s(t.title))]):t._e()])])])};u._withStripped=!0;const d={name:"AccountEditIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var p=s(51900);const m=(0,p.Z)(d,u,[],!1,null,null,null).exports;var h=function(){var t=this,e=t._self._c;return e("span",t._b({staticClass:"material-design-icon email-edit-outline-icon",attrs:{"aria-hidden":!t.title,"aria-label":t.title,role:"img"},on:{click:function(e){return t.$emit("click",e)}}},"span",t.$attrs,!1),[e("svg",{staticClass:"material-design-icon__svg",attrs:{fill:t.fillColor,width:t.size,height:t.size,viewBox:"0 0 24 24"}},[e("path",{attrs:{d:"M19.07 13.88L13 19.94V22H15.06L21.12 15.93M22.7 13.58L21.42 12.3C21.32 12.19 21.18 12.13 21.04 12.13C20.89 12.14 20.75 12.19 20.65 12.3L19.65 13.3L21.7 15.3L22.7 14.3C22.89 14.1 22.89 13.78 22.7 13.58M11 18H4V8L12 13L20 8V10H22V6C22 4.9 21.1 4 20 4H4C2.9 4 2 4.9 2 6V18C2 19.1 2.9 20 4 20H11V18M20 6L12 11L4 6H20Z"}},[t.title?e("title",[t._v(t._s(t.title))]):t._e()])])])};h._withStripped=!0;const _={name:"EmailEditOutlineIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};const f=(0,p.Z)(_,h,[],!1,null,null,null).exports;var A=s(99672),y=s(50171),v=s(15101),g=s(54512),b=function(){var t=this,e=t._self._c;return e("span",t._b({staticClass:"material-design-icon logout-icon",attrs:{"aria-hidden":!t.title,"aria-label":t.title,role:"img"},on:{click:function(e){return t.$emit("click",e)}}},"span",t.$attrs,!1),[e("svg",{staticClass:"material-design-icon__svg",attrs:{fill:t.fillColor,width:t.size,height:t.size,viewBox:"0 0 24 24"}},[e("path",{attrs:{d:"M16,17V14H9V10H16V7L21,12L16,17M14,2A2,2 0 0,1 16,4V6H14V4H5V20H14V18H16V20A2,2 0 0,1 14,22H5A2,2 0 0,1 3,20V4A2,2 0 0,1 5,2H14Z"}},[t.title?e("title",[t._v(t._s(t.title))]):t._e()])])])};b._withStripped=!0;const k={name:"LogoutIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};const V=(0,p.Z)(k,b,[],!1,null,null,null).exports;var N=s(61839),C=s(66037),E=s(53154);const w=t=>{t.success=!1,t.error=!0,t.showTrailingButton=!1},$=t=>{t.success=!0,t.error=!1,t.showTrailingButton=!0},L=t=>{t.success=!1,t.error=!1,t.showTrailingButton=!1},S={name:"UserMenu",components:{NcActions:r.O3,NcActionButton:r.Js,NcActionCheckbox:r.Bt,NcActionInput:r.Iw,NcActionSeparator:r.rr,SettingsIcon:c.default,EditAccountIcon:m,EditEmailIcon:f,LogoutIcon:V,SendLinkPerEmailIcon:A.default,DeleteIcon:y.Z,ClippyIcon:v.Z,ResetVotesIcon:g.default},data:()=>({userEmail:{inputValue:"",inputProps:{success:!1,error:!1,showTrailingButton:!0}},userName:{inputValue:"",inputProps:{success:!1,error:!1,showTrailingButton:!0}}}),computed:{...(0,o.rn)({acl:t=>t.poll.acl,share:t=>t.share,subscribed:t=>t.subscription.subscribed,emailAddress:t=>t.share.emailAddress,displayName:t=>t.poll.acl.displayName}),hasCookie(){return!!(0,N.Yv)(this.$route.params.token)},personalLink(){return window.location.origin+this.$router.resolve({name:"publicVote",params:{token:this.$route.params.token}}).href}},watch:{emailAddress(){this.userEmail.inputValue=this.emailAddress},displayName(){this.userName.inputValue=this.displayName}},created(){this.userEmail.inputValue=this.emailAddress,this.userName.inputValue=this.displayName},methods:{logout(){const t=(0,N.Dp)(this.$route.params.token);t&&this.$router.push({name:"publicVote",params:{token:t}})},async toggleSubscription(){await this.$store.dispatch("subscription/update",!this.subscribed)},async deleteEmailAddress(){try{await this.$store.dispatch("share/deleteEmailAddress"),(0,n.s$)(t("polls","Email address deleted."))}catch{(0,n.x2)(t("polls","Error deleting email address {emailAddress}",{emailAddress:this.userEmail.inputValue}))}},validateEmailAddress:(0,l.debounce)((async function(){const t=this.userEmail.inputProps;if(this.userEmail.inputValue!==this.emailAddress)try{await E.c.validateEmailAddress(this.userEmail.inputValue),$(t)}catch{w(t)}else L(t)}),500),validateDisplayName:(0,l.debounce)((async function(){const t=this.userName.inputProps;if(this.userName.inputValue.length<1)w(t);else if(this.userName.inputValue!==this.displayName)try{await E.c.validateName(this.$route.params.token,this.userName.inputValue),$(t)}catch{w(t)}else L(t)}),500),async submitEmailAddress(){try{await this.$store.dispatch("share/updateEmailAddress",{emailAddress:this.userEmail.inputValue}),(0,n.s$)(t("polls","Email address {emailAddress} saved.",{emailAddress:this.userEmail.inputValue})),L(this.userEmail.inputProps)}catch{(0,n.x2)(t("polls","Error saving email address {emailAddress}",{emailAddress:this.userEmail.inputValue})),w(this.userEmail.inputProps)}},async submitDisplayName(){try{await this.$store.dispatch("share/updateDisplayName",{displayName:this.userName.inputValue}),L(this.userName.inputProps),(0,n.s$)(t("polls","Name changed."))}catch{(0,n.x2)(t("polls","Error changing name.")),w(this.userName.inputProps)}},async resendInvitation(){try{const e=await this.$store.dispatch("share/resendInvitation");(0,n.s$)(t("polls","Invitation resent to {emailAddress}",{emailAddress:e.data.share.emailAddress}))}catch{(0,n.x2)(t("polls","Mail could not be resent to {emailAddress}",{emailAddress:this.share.emailAddress}))}},async copyLink(){try{await navigator.clipboard.writeText(this.personalLink),(0,n.s$)(t("polls","Link copied to clipboard"))}catch{(0,n.x2)(t("polls","Error while copying link to clipboard"))}},async getAddresses(){try{const e=await C.e.getParticipantsEmailAddresses(this.$route.params.id);await navigator.clipboard.writeText(e.data.map((t=>t.combined))),(0,n.s$)(t("polls","Link copied to clipboard"))}catch(e){if("ERR_CANCELED"===(null==e?void 0:e.code))return;(0,n.x2)(t("polls","Error while copying link to clipboard"))}},async resetVotes(){try{await this.$store.dispatch("votes/resetVotes"),(0,n.s$)(t("polls","Your votes are reset"))}catch{(0,n.x2)(t("polls","Error while resetting votes"))}}}};const I=(0,p.Z)(S,a,[],!1,null,null,null).exports}}]);
//# sourceMappingURL=polls-src_js_components_User_UserMenu_vue.js.map?v=de594958d3a2d4fff0e2